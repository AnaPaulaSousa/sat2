<h2 class="page-title">
    Alunos
</h2>

<!-- /.row -->
<div class="row">
    <!-- /.col-lg-12 -->
    <div class="col-lg-12">
        <section class="widget">
            <div class="body">

                <form id="aluno-form" role="form" ng-submit="save()">
                    <fieldset>

                        <legend class="section" style="font-weight:600;">Cadastrar Aluno</legend>

                        <div class="form-group">
                            <input id="id" name="id" ng-model="aluno.id" type="hidden">
                        </div>

                        <div class="row">
                            <div class="col-md-5">
                                <div class="form-group">
                                    <label for="nome">Nome</label>
                                    <input type="text" id="nome" name="nome" class="form-control" placeholder="Nome do Aluno"
                                           ng-model="aluno.nome">
                                    <ul class="parsley-errors-list filled" id="nome-errors"></ul>
                                </div>
                            </div>
                        </div>

                        <div class="row">

                            <div class="col-md-1">
                                <div class="form-group">
                                    <label for="situacao">Situação</label>
                                    <div class="input-group">
                                        <div id="situacao" class="btn-group" data-toggle="buttons">
                                            <input type="checkbox" name="situacao" ng-model="aluno.situacao"> Ativo
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="sexo">Sexo</label>
                                    <select data-width="auto" name="sexo" id="sexo" ng-model="aluno.sexo"
                                            data-minimum-results-for-search="10" tabindex="-1"
                                            class="select2 form-control" id="default-select" data-parsley-required>
                                        <option value="M">Masculino</option>
                                        <option value="F">Feminino</option>
                                    </select>
                                    <ul class="parsley-errors-list filled" id="sexo-errors"></ul>
                                </div>
                            </div>

                        </div>

                    </fieldset>
                    <div class="form-actions">
                        <div class="btn-toolbar">

                            <button type="submit" name="action" class="btn btn-primary pull-right">
                                <i class="fa fa-save" style="margin-right:4px;" id="show-info-message"></i> Salvar
                            </button>

                            <button type="button" name="action" class="btn btn-primary pull-right" ng-click="limparForm()">
                                <i class="fa fa-repeat" style="margin-right:4px;" id="show-info-message"></i> Limpar
                            </button>


                            <button type="button" name="action" class="btn btn-outline btn-danger pull-right"
                                     ng-if="aluno.id" data-toggle="modal" data-target="#confirm-delete">
                                <i class="fa fa-trash" style="margin-right:4px;" id="show-info-message"></i> Excluir
                            </button>

                        </div>
                    </div>

                </form>

                <div id="confirm-delete" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                                <h4 class="modal-title" id="myModalLabel">Confirmar Exclusão</h4>
                            </div>
                            <div class="modal-body">
                                <p>Confirma a exclusão do registo?</p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                                <button type="button" class="btn btn-danger" ng-click="delete()">Confirmar</button>
                            </div>

                        </div><!-- /.modal-content -->
                    </div><!-- /.modal-dialog -->
                </div>

                <fieldset>
                    <legend class="section" style="font-weight: 600;">Alunos</legend>

                    <div class="dataTable_wrapper">
                        <table id="dataTables-alunos" class="display table table-hover" cellspacing="0" width="100%">
                            <thead>
                            <tr style="background: #F5F5F5;">
                                <th name="id" style="width: 5%">Id</th>
                                <th name="nome" style="width: 40%">Nome</th>
                                <th name="email" style="width: 15%">Email</th>
                                <th style="width: 5%"></th>
                            </tr>
                            </thead>
                            <tfoot>
                            <tr style="background: #F5F5F5;">
                                <th><input id="id-search" type="text" placeholder="Id" /></th>
                                <th><input id="nome-search" type="text" placeholder="Filtrar por Nome" /></th>
                                <th><input id="email-search" type="text" placeholder="Filtrar por Email" /></th>
                                <th></th>
                            </tr>
                            </tfoot>
                        </table>

                    </div>

                </fieldset>

            </div>
            <!-- /.panel-body -->

        </section>
        <!-- /.panel -->
    </div>

    <script>

        $(document).ready(function() {
            $('#dataTables-alunos').DataTable({
                "processing": true,
                "serverSide": true,
                dom: 'T clear rtip', //Remove filtro de pesquisa
                "ajax": "../api/aluno/paginar",
                "language": {
                    "url": "../js/Portuguese-Brasil.json"
                },
                "columns": [
                    { "data": "id" },
                    { "data": "nome" },
                    { "data": "email" },
                    {
                        "class":          "edit-table-cell",
                        "orderable":      false,
                        "data":           null,
                        "defaultContent": "<button class='btn btn-primary'><i class='fa fa-pencil'></i></button>"
                    }
                ]
            }).columns().every( function () {
                var that = this;

                var id = $(this.header()).attr("name")+"-search"

                $("#"+id).on( 'keyup change', function () {
                    if ( that.search() !== this.value) {
                        that.search( this.value ).draw();
                    }
                } );
            });

            $('#dataTables-alunos').on( 'mouseover', 'tbody tr', function () {
                var id = $($(this)[0].cells[0]).text()
                var jsCall = "angular.element($('#container')).scope().edit('"+id+"')";
                $($(this)[0].cells[5]).find("button").first().attr("onclick", jsCall);
            } );

        });

    </script>

</div>
<!-- /.row -->